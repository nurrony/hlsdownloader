pre-commit:
  parallel: false
  jobs:
    - name: Validate Types
      run: npm run typecheck
    - name: Lint and Fix Coding Style (Staged files)
      stage_fixed: true
      exclude:
        - 'docs/**/*'
        - 'dist/**/*'
        - 'coverage/**/*'
        - 'node_modules/**/*'
        - 'package-lock.json'
      glob:
        - '*.ts'
        - '**/*.ts'
        - '*.json'
      run: npx --no-install eslint --fix {staged_files}
    - name: Format Code
      stage_fixed: true
      glob:
        - '*.{ts,js,json,md}'
        - '**/*.{ts,js,json,md}'
      exclude:
        - 'dist/**/*'
        - 'package-lock.json'
        - 'coverage/**/*'
        - 'node_modules/**/*'
      run: npx --no-install prettier --write {staged_files}
    - name: 'Running Unit Tests'
      run: npm run test:coverage
      stage_fixed: true

# Build commit messages
prepare-commit-msg:
  jobs:
    - name: 'Prepare Conventional Commit Message'
      interactive: true
      env:
        LEFTHOOK: '0'
      skip:
        - merge
        - rebase
      run: |
        echo "‚è≥ Openning Conventional Commit Prompt...\n";
        npx cz --hook

# Validate commit messages
commit-msg:
  jobs:
    - name: 'Lint Commit Message'
      skip:
        - merge
        - rebase
      run: |
        npx --no-install commitlint --edit {1}
        echo 'üîñ Commit message guidelines are followed properly.'

output:
  - summary
  - success
  - failure
  - execution_out
